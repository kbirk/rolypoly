!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.rolypoly=e()}}(function(){return function e(t,n,s){function o(c,i){if(!n[c]){if(!t[c]){var l="function"==typeof require&&require;if(!i&&l)return l(c,!0);if(r)return r(c,!0);var a=new Error("Cannot find module '"+c+"'");throw a.code="MODULE_NOT_FOUND",a}var u=n[c]={exports:{}};t[c][0].call(u.exports,function(e){var n=t[c][1][e];return o(n?n:e)},u,u.exports,e,t,n,s)}return n[c].exports}for(var r="function"==typeof require&&require,c=0;c<s.length;c++)o(s[c]);return o}({1:[function(e,t){!function(){"use strict";t.exports={Keyboard:e("./Keyboard"),Mouse:e("./Mouse")}}()},{"./Keyboard":4,"./Mouse":6}],2:[function(e,t){!function(){"use strict";function n(e){this.buffer=new Array(e),this.length=e,this.index=0}var s=e("./Util");n.prototype.push=function(e){this.buffer[this.index]=e,this.index=(this.index+1)%this.length},n.prototype.back=function(e){return e=e?e:0,this.buffer[s.mod(this.index-1-e,this.length)]},t.exports=n}()},{"./Util":8}],3:[function(e,t){!function(){"use strict";var n=e("./Keys");t.exports={8:n.BACKSPACE,9:n.TAB,13:n.ENTER,16:n.SHIFT,17:n.CTRL,18:n.ALT,19:n.PAUSE_BREAK,20:n.CAPS_LOCK,27:n.ESC,32:n.SPACE_BAR,33:n.PAGE_UP,34:n.PAGE_DOWN,35:n.END,36:n.HOME,37:n.LEFT_ARROW,38:n.UP_ARROW,39:n.RIGHT_ARROW,40:n.DOWN_ARROW,44:n.PRINT_SCREEN,45:n.INSERT,46:n.DELETE,48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:n.WINDOWS,92:n.WINDOWS,93:n.SELECT,96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:n.NUM_LOCK,145:n.SCROLL_LOCK,186:":",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}}()},{"./Keys":5}],4:[function(e,t){!function(){"use strict";function n(e){return e.length>1?e.split(" "):[e]}function s(e){return e.length>1?e.split("+"):[e]}function o(e,t,s,o){var r,c,i,l,a=n(t),u=e.keys,f=e.sequences;for(f[t]=f[t]||{keys:a,lastKey:a[a.length-1],callbacks:{}},r=f[t],l=0;l<s.length;l++)for(c=s[l],r.callbacks[c]=r.callbacks[c]||[],r.callbacks[c].push(o),l=0;l<a.length;l++)i=a[l],u[i]=u[i]||{},u[i].sequences=u[i].sequences||{},u[i].sequences[c]=u[i].sequences[c]||[],-1===u[i].sequences[c].indexOf(t)&&u[i].sequences[c].push(t)}function r(e,t,s,o){var r,c,i,l,a=n(t),u=e.keys,f=e.sequences,p=f[t];if(p){for(l=0;l<s.length;l++)c=s[l],r=p.callbacks,r&&r[c]&&(r[c].splice(r[c].indexOf(o),1),0===r[c].length&&delete r[c]);if(v.isEmpty(p.callbacks))for(delete f[t],l=0;l<s.length;l++)for(c=s[l],l=0;l<a.length;l++)i=a[l],f=u[i].sequences[c],f.splice(f.indexOf(t),1)}}function c(e,t,n,o){var r,c,i,l,a=s(t),u=e.keys,f=e.combos;for(f[t]=f[t]||{keys:a,callbacks:{}},r=f[t],l=0;l<n.length;l++)for(c=n[l],r.callbacks[c]=r.callbacks[c]||[],r.callbacks[c].push(o),l=0;l<a.length;l++)i=a[l],u[i]=u[i]||{},u[i].combos=u[i].combos||{},u[i].combos[c]=u[i].combos[c]||[],u[i].combos[c].push(t),-1===u[i].combos[c].indexOf(t)&&u[i].combos[c].push(t)}function i(e,t,n,o){var r,c,i,l,a=s(t),u=e.keys,f=e.combos,p=f[t];if(p){for(l=0;l<n.length;l++)c=n[l],r=p.callbacks,r&&r[c]&&(r[c].splice(r[c].indexOf(o),1),0===r[c].length&&delete r[c]);if(v.isEmpty(p.callbacks))for(delete f[t],l=0;l<n.length;l++)for(c=n[l],l=0;l<a.length;l++)i=a[l],f=u[i].combos[c],f.splice(f.indexOf(t),1)}}function l(e,t,n,s){var o,r,c=e.keys,i=c[t]=c[t]||{};for(r=0;r<n.length;r++)o=n[r],i.callbacks=i.callbacks||{},i.callbacks[o]=i.callbacks[o]||[],i.callbacks[o].push(s)}function a(e,t,n,s){var o,r,c,i=e.keys,l=i[t];if(l)for(c=0;c<n.length;c++)r=n[c],o=l.callbacks,o&&o[r]&&(o[r].splice(o[r].indexOf(s),1),0===o[r].length&&delete o[r])}function u(e,t,n){var s,o,r=e.keys,c=t.keys;for(o=0;o<c.length;o++){if(s=r[c[o]],!s)return!1;if("release"===n&&(!t.pressed||"up"!==s.state))return!1;if("press"===n&&"down"!==s.state)return!1}return"press"===n?t.pressed=!0:"release"===n&&delete t.pressed,!0}function f(e,t,n,s){var o,r,c=e.combos;if(t.combos&&t.combos[n])for(r=0;r<t.combos[n].length;r++)o=c[t.combos[n][r]],o&&u(e,o,n)&&v.executeCallbacks(o.callbacks,n,s)}function p(e,t){var n;return e?(n=e-t,O>n):!0}function h(e,t){var n,s,o,r,c;for(r=0,c=0;r<t.length;r++,c++){for(s=t[t.length-1-r],o=e.back(c);"shift"!==s&&o&&"shift"===o.keyId;)c++,o=e.back(c);if(!o||o.keyId!==s||!p(n,o.timestamp))return!1;n=o.timestamp}return!0}function d(e,t,n,s,o){var r,c,i,l=e.sequences;if(t.sequences&&t.sequences[s])for(c="press"===s?e.pressHistory:e.releaseHistory,i=0;i<t.sequences[s].length;i++)r=l[t.sequences[s][i]],r.lastKey===n&&h(c,r.keys)&&v.executeCallbacks(r.callbacks,s,o)}function b(e){var t=e.charCode||e.keyCode;return E[t]||t}function m(e,t){var n=e[A.SHIFT];return n&&"down"===n.state?x[t]||t:t}function g(e){return function(t){var n,s=b(t),o=e.keys;s=m(o,s),n=o[s]=o[s]||{},n.state="down",e.pressHistory.push({keyId:s,timestamp:Date.now()}),v.executeCallbacks(n.callbacks,"press",t),f(e,n,"press",t),d(e,n,s,"press",t)}}function k(e){return function(t){var n,s=b(t),o=e.keys;s=m(o,s),n=o[s],n&&"down"===n.state&&(n.state="up",e.releaseHistory.push({keyId:s,timestamp:Date.now()}),v.executeCallbacks(n.callbacks,"release",t),f(e,n,"release",t),d(e,n,s,"release",t))}}function y(){this.keys={},this.combos={},this.sequences={},this.pressHistory=new C(R),this.releaseHistory=new C(R),document.addEventListener("keydown",g(this)),document.addEventListener("keyup",k(this))}var v=e("./Util"),A=e("./Keys"),E=e("./KeyMap"),x=e("./ShiftMap"),C=e("./CircularArray"),O=800,R=64;y.prototype.on=function(e,t,r){var i,a;if(v.checkFunctionArg("Keyboard.on",t))return this;for(e=v.normalizeInputArgs("Keyboard.on",e),r=v.normalizeEventArgs("Keyboard.on",r),a=0;a<e.length;a++)i=e[a],n(i).length>1?o(this,i,r,t):s(i).length>1?c(this,i,r,t):l(this,i,r,t);return this},y.prototype.off=function(e,t,o){var c,l;if(v.checkFunctionArg("Keyboard.off",t))return this;for(e=v.normalizeInputArgs("Keyboard.off",e),o=v.normalizeEventArgs("Keyboard.off",o),l=0;l<e.length;l++)c=e[l],n(c).length>1?r(this,c,o,t):s(c).length>1?i(this,c,o,t):a(this,c,o,t);return this},y.prototype.poll=function(e){var t,n,s=[];for(e=v.normalizeInputArgs("Keyboard.poll",e),n=0;n<e.length;n++)t=this.keys[e[n]],s.push(t?t.state:"up");return 1===s.length?s[0]:s},t.exports=y}()},{"./CircularArray":2,"./KeyMap":3,"./Keys":5,"./ShiftMap":7,"./Util":8}],5:[function(e,t){!function(){"use strict";t.exports={BACKSPACE:"backspace",TAB:"tab",ENTER:"enter",SHIFT:"shift",CTRL:"ctrl",ALT:"alt",PAUSE_BREAK:"pausebreak",CAPS_LOCK:"capslock",ESC:"esc",PAGE_UP:"pageup",PAGE_DOWN:"pagedown",END:"end",HOME:"home",LEFT_ARROW:"left",UP_ARROW:"up",RIGHT_ARROW:"right",DOWN_ARROW:"down",PRINT_SCREEN:"printscreen",INSERT:"insert",DELETE:"delete",WINDOWS:"windows",SELECT:"select",SPACE_BAR:"space",NUM_LOCK:"numlock",SCROLL_LOCK:"scrolllock"}}()},{}],6:[function(e,t){!function(){"use strict";function n(e){switch(e.button){case 0:return"left";case 1:return"middle";case 2:return"right"}}function s(e){return function(t){var s,o=n(t);s=e[o]=e[o]||{state:null},s.state="down",i.executeCallbacks(s.callbacks,"press",t)}}function o(e){return function(t){var s=n(t),o=e[s];o&&"down"===o.state&&(i.executeCallbacks(o.callbacks,"release",t),o.state="up")}}function r(e){var t=null;return function(n){t&&n.clientX===t.x&&n.clientY===t.y||(t&&(n.previousClientX=t.x,n.previousClientY=t.y),i.executeCallbacks(e.callbacks,"move",n),t={x:n.clientX,y:n.clientY})}}function c(){this.buttons={},this.mouse={},document.addEventListener("mousedown",s(this.buttons)),document.addEventListener("mouseup",o(this.buttons)),document.addEventListener("mousemove",r(this.mouse))}var i=e("./Util");c.prototype.on=function(e,t,n){var s,o,r,c,l,a;if(i.checkFunctionArg("Mouse.on",t))return this;for(e=i.normalizeInputArgs("Mouse.on",e,["left","middle","right","move"]),n=i.normalizeEventArgs("Mouse.on",n),l=0;l<e.length;l++)if(c=e[l],"move"===c)o=this.mouse,o.callbacks=o.callbacks||{},o.callbacks.move=o.callbacks.move||[],o.callbacks.move.push(t);else for(s=this.buttons[c]=this.buttons[c]||{},a=0;a<n.length;a++)r=n[a],s.callbacks=s.callbacks||{},s.callbacks[r]=s.callbacks[r]||[],s.callbacks[r].push(t);return this},c.prototype.off=function(e,t,n){var s,o,r,c,l,a;if(i.checkFunctionArg("Mouse.off",t))return this;for(e=i.normalizeInputArgs("Mouse.off",e,["left","middle","right","move"]),n=i.normalizeEventArgs("Mouse.off",n),l=0;l<e.length;l++)if(c=e[l],"move"===c)o=this.mouse,o.callbacks&&o.callbacks.move&&o.callbacks.move.splice(o.callbacks.move.indexOf(t));else for(s=this.buttons[c]=this.buttons[c]||{},a=0;a<n.length;a++)r=n[a],s.callbacks&&s.callbacks[r]&&s.callbacks[r].splice(s.callbacks[r].indexOf(t));return this},c.prototype.poll=function(e){var t,n,s=[];for(e=i.normalizeInputArgs("Mouse.poll",e,["left","middle","right","move"]),n=0;n<e.length;n++)t=this.buttons[e[n]],s.push(t?t.state:"up");return 1===s.length?s[0]:s},t.exports=c}()},{"./Util":8}],7:[function(e,t){!function(){"use strict";t.exports={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=","{":"[","}":"]","|":"\\",":":";",'"':"'","<":",",">":".","?":"/","`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+","[":"{","]":"}","\\":"|",";":":","":'"',",":"<",".":">","/":"?"}}()},{}],8:[function(e,t){!function(){"use strict";t.exports={normalizeString:function(e){return e=e.toLowerCase(),e.replace(/[\s]/g," ")},checkFunctionArg:function(e,t){return"function"!=typeof t?(console.log("Argument 'callback' to '"+e+"' is not of type 'function', command ignored."),!0):!1},normalizeInputArgs:function(e,t,n){var s,o=[];for(t instanceof Array||(t=[t]),s=0;s<t.length;s++)"string"==typeof t[s]?n&&-1===n.indexOf(t[s])?console.log("Argument '"+t[s]+"' to '"+e+"' is not a recognized input type, argument removed."):o.push(this.normalizeString(t[s])):console.log("Argument '"+t[s]+"' to '"+e+"' is not of type 'string', argument removed.");return o},normalizeEventArgs:function(e,t){var n;for(t||(t=["press"]),t instanceof Array||(t=[t]),n=0;n<t.length;n++)"press"!==t[n]&&"release"!==t[n]?console.log("Argument '"+t[n]+"' to '"+e+"' is not a recognized event type, argument removed."):t[n]=this.normalizeString(t[n]);return t},executeCallbacks:function(e,t,n){var s;if(e&&e[t])for(e=e[t],s=0;s<e.length;s++)e[s](n)},mod:function(e,t){return(e%t+t)%t},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}}}()},{}]},{},[1])(1)});