!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.rolypoly=e()}}(function(){return function e(t,n,s){function o(c,i){if(!n[c]){if(!t[c]){var a="function"==typeof require&&require;if(!i&&a)return a(c,!0);if(r)return r(c,!0);var l=new Error("Cannot find module '"+c+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[c]={exports:{}};t[c][0].call(u.exports,function(e){var n=t[c][1][e];return o(n?n:e)},u,u.exports,e,t,n,s)}return n[c].exports}for(var r="function"==typeof require&&require,c=0;c<s.length;c++)o(s[c]);return o}({1:[function(e,t,n){!function(){"use strict";t.exports={Keyboard:e("./Keyboard"),Mouse:e("./Mouse"),Touch:e("./Touch")}}()},{"./Keyboard":5,"./Mouse":7,"./Touch":9}],2:[function(e,t,n){!function(){"use strict";function n(e){e=e||256,this.buffer=new Array(e),this.length=e,this.index=0}var s=e("./Util");n.prototype.push=function(e){this.buffer[this.index]=e,this.index=(this.index+1)%this.length},n.prototype.back=function(e){return e=e?e:0,this.buffer[s.mod(this.index-1-e,this.length)]},t.exports=n}()},{"./Util":10}],3:[function(e,t,n){!function(){"use strict";t.exports={BACKSPACE:"backspace",TAB:"tab",ENTER:"enter",SHIFT:"shift",CTRL:"ctrl",ALT:"alt",PAUSE_BREAK:"pausebreak",CAPS_LOCK:"capslock",ESC:"esc",PAGE_UP:"pageup",PAGE_DOWN:"pagedown",END:"end",HOME:"home",LEFT_ARROW:"left",UP_ARROW:"up",RIGHT_ARROW:"right",DOWN_ARROW:"down",PRINT_SCREEN:"printscreen",INSERT:"insert",DELETE:"delete",WINDOWS:"windows",SELECT:"select",SPACE_BAR:"space",NUM_LOCK:"numlock",SCROLL_LOCK:"scrolllock"}}()},{}],4:[function(e,t,n){!function(){"use strict";var n=e("./KeyEnums");t.exports={8:n.BACKSPACE,9:n.TAB,13:n.ENTER,16:n.SHIFT,17:n.CTRL,18:n.ALT,19:n.PAUSE_BREAK,20:n.CAPS_LOCK,27:n.ESC,32:n.SPACE_BAR,33:n.PAGE_UP,34:n.PAGE_DOWN,35:n.END,36:n.HOME,37:n.LEFT_ARROW,38:n.UP_ARROW,39:n.RIGHT_ARROW,40:n.DOWN_ARROW,44:n.PRINT_SCREEN,45:n.INSERT,46:n.DELETE,48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:n.WINDOWS,92:n.WINDOWS,93:n.SELECT,96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:n.NUM_LOCK,145:n.SCROLL_LOCK,186:":",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}}()},{"./KeyEnums":3}],5:[function(e,t,n){!function(){"use strict";function n(e,t){var n;for(n=0;n<t.length;n++)if(!C[t[n]])return console.log("Argument '"+t[n]+"' to '"+e+"' is not a recognized event type, command ignored."),!0;return!1}function s(e){return e.split(" ").length>1}function o(e){return e.split(" ")}function r(e){return e.length>1?e.split("+").length>1:!1}function c(e){var t,n=e.split(/\+\+\+|\+\+/),s=[];if(n.length>1)for(t=0;t<n.length;t++)0===n[t].length?0===t&&s.push("+"):(s=s.concat(n[t].split("+")),t!==n.length-1&&s.push("+"));else s=e.split("+");return s}function i(e,t,s,r){var c,i,a,l,u=o(t),f=e.keys,h=e.sequences;if(!n("Keyboard.on",u))for(h[t]=h[t]||{keys:u,lastKey:u[u.length-1],callbacks:{}},c=h[t],l=0;l<s.length;l++)for(i=s[l],c.callbacks[i]=c.callbacks[i]||[],c.callbacks[i].push(r),l=0;l<u.length;l++)a=u[l],f[a]=f[a]||{},f[a].sequences=f[a].sequences||{},f[a].sequences[i]=f[a].sequences[i]||[],-1===f[a].sequences[i].indexOf(t)&&f[a].sequences[i].push(t)}function a(e,t,s,r){var c,i,a,l,u=o(t),f=e.keys,h=e.sequences,p=h[t];if(!n("Keyboard.off",u)&&p){for(l=0;l<s.length;l++)i=s[l],c=p.callbacks,c&&c[i]&&(c[i].splice(c[i].indexOf(r),1),0===c[i].length&&delete c[i]);if(x.isEmpty(p.callbacks))for(delete h[t],l=0;l<s.length;l++)for(i=s[l],l=0;l<u.length;l++)a=u[l],h=f[a].sequences[i],h.splice(h.indexOf(t),1)}}function l(e,t,s,o){var r,i,a,l,u=c(t),f=e.keys,h=e.combos;if(!n("Keyboard.on",u))for(h[t]=h[t]||{keys:u,callbacks:{}},r=h[t],l=0;l<s.length;l++)for(i=s[l],r.callbacks[i]=r.callbacks[i]||[],r.callbacks[i].push(o),l=0;l<u.length;l++)a=u[l],f[a]=f[a]||{},f[a].combos=f[a].combos||{},f[a].combos[i]=f[a].combos[i]||[],-1===f[a].combos[i].indexOf(t)&&f[a].combos[i].push(t)}function u(e,t,s,o){var r,i,a,l,u=c(t),f=e.keys,h=e.combos,p=h[t];if(!n("Keyboard.off",u)&&p){for(l=0;l<s.length;l++)i=s[l],r=p.callbacks,r&&r[i]&&(r[i].splice(r[i].indexOf(o),1),0===r[i].length&&delete r[i]);if(x.isEmpty(p.callbacks))for(delete h[t],l=0;l<s.length;l++)for(i=s[l],l=0;l<u.length;l++)a=u[l],h=f[a].combos[i],h.splice(h.indexOf(t),1)}}function f(e,t,s,o){var r,c,i=e.keys,a=i[t]=i[t]||{};if(!n("Keyboard.on",[t]))for(c=0;c<s.length;c++)r=s[c],a.callbacks=a.callbacks||{},a.callbacks[r]=a.callbacks[r]||[],a.callbacks[r].push(o)}function h(e,t,s,o){var r,c,i,a=e.keys,l=a[t];if(!n("Keyboard.off",[t])&&l)for(i=0;i<s.length;i++)c=s[i],r=l.callbacks,r&&r[c]&&(r[c].splice(r[c].indexOf(o),1),0===r[c].length&&delete r[c])}function p(e,t,n){var s,o,r=e.keys,c=t.keys;for(o=0;o<c.length;o++){if(s=r[c[o]],!s)return!1;if("release"===n&&(!t.pressed||"up"!==s.state))return!1;if("press"===n&&"down"!==s.state)return!1}return"press"===n?t.pressed=!0:"release"===n&&delete t.pressed,!0}function d(e,t,n,s){var o,r,c=e.combos;if(t.combos)if("press"===n){if(t.combos.press)for(r=0;r<t.combos.press.length;r++)o=c[t.combos.press[r]],p(e,o,"press")&&x.executeCallbacks(o.callbacks,"press",s);if(t.combos.release)for(r=0;r<t.combos.release.length;r++)o=c[t.combos.release[r]],p(e,o,"press")}else if(t.combos.release)for(r=0;r<t.combos.release.length;r++)o=c[t.combos.release[r]],p(e,o,"release")&&x.executeCallbacks(o.callbacks,"release",s)}function b(e,t){var n;return e?(n=e-t,S>n):!0}function m(e,t){var n,s,o,r,c;for(r=0,c=0;r<t.length;r++,c++){for(s=t[t.length-1-r],o=e.back(c);"shift"!==s&&o&&"shift"===o.keyId;)c++,o=e.back(c);if(!o||o.keyId!==s||!b(n,o.timestamp))return!1;n=o.timestamp}return!0}function g(e,t,n,s,o){var r,c,i,a=e.sequences;if(t.sequences&&t.sequences[s])for(c="press"===s?e.pressHistory:e.releaseHistory,i=0;i<t.sequences[s].length;i++)r=a[t.sequences[s][i]],r.lastKey===n&&m(c,r.keys)&&x.executeCallbacks(r.callbacks,s,o)}function y(e){var t=e.charCode||e.keyCode;return K[t]||t}function k(e,t){var n=e[O.SHIFT];return n&&"down"===n.state?R[t]||t:t}function v(e){return function(t){var n,s=y(t),o=e.keys;s=k(o,s),n=o[s]=o[s]||{},n.state="down",e.pressHistory.push({keyId:s,timestamp:Date.now()}),x.executeCallbacks(n.callbacks,"press",t),d(e,n,"press",t),g(e,n,s,"press",t)}}function E(e){return function(t){var n,s=y(t),o=e.keys;s=k(o,s),n=o[s],n&&"down"===n.state&&(n.state="up",e.releaseHistory.push({keyId:s,timestamp:Date.now()}),x.executeCallbacks(n.callbacks,"release",t),d(e,n,"release",t),g(e,n,s,"release",t))}}function A(){this.keys={},this.combos={},this.sequences={},this.pressHistory=new L(T),this.releaseHistory=new L(T),document.addEventListener("keydown",v(this)),document.addEventListener("keyup",E(this))}var x=e("./Util"),C=e("./Keys"),O=e("./KeyEnums"),K=e("./KeyMap"),R=e("./ShiftMap"),L=e("./CircularArray"),S=800,T=64;A.prototype.on=function(e,t,n){var o,c;if(x.checkFunctionArg("Keyboard.on",t))return this;for(e=x.normalizeInputArgs("Keyboard.on",e),n=x.normalizeEventArgs("Keyboard.on",n),c=0;c<e.length;c++)o=e[c],s(o)?i(this,o,n,t):r(o)?l(this,o,n,t):f(this,o,n,t);return this},A.prototype.off=function(e,t,n){var o,c;if(x.checkFunctionArg("Keyboard.off",t))return this;for(e=x.normalizeInputArgs("Keyboard.off",e),n=x.normalizeEventArgs("Keyboard.off",n),c=0;c<e.length;c++)o=e[c],s(o)?a(this,o,n,t):r(o)?u(this,o,n,t):h(this,o,n,t);return this},A.prototype.poll=function(e){var t,n,s,o={};if(e=x.normalizeInputArgs("Keyboard.poll",e),1===e.length)return n=this.keys[e[0]],n?n.state:"up";for(s=0;s<e.length;s++)t=e[s],n=this.keys[t],o[t]=n?n.state:"up";return o},t.exports=A}()},{"./CircularArray":2,"./KeyEnums":3,"./KeyMap":4,"./Keys":6,"./ShiftMap":8,"./Util":10}],6:[function(e,t,n){!function(){"use strict";var n,s=e("./KeyMap"),o=e("./ShiftMap"),r={};for(n in s)r[s[n]]=!0;for(n in o)r[o[n]]=!0;t.exports=r}()},{"./KeyMap":4,"./ShiftMap":8}],7:[function(e,t,n){!function(){"use strict";function n(e){switch(e.button){case 0:return"left";case 1:return"middle";case 2:return"right"}}function s(e){return function(t){var s,o=n(t);s=e[o]=e[o]||{state:null},s.state="down",i.executeCallbacks(s.callbacks,"press",t)}}function o(e){return function(t){var s=n(t),o=e[s];o&&"down"===o.state&&(i.executeCallbacks(o.callbacks,"release",t),o.state="up")}}function r(e){var t=null;return function(n){t&&n.clientX===t.x&&n.clientY===t.y||(t&&(n.previousClientX=t.x,n.previousClientY=t.y),i.executeCallbacks(e.callbacks,"move",n),t={x:n.clientX,y:n.clientY})}}function c(e){this.buttons={},this.mouse={};var t;t="string"==typeof e?document.querySelector(e):e||document,t.addEventListener("mousedown",s(this.buttons)),t.addEventListener("mouseup",o(this.buttons)),t.addEventListener("mousemove",r(this.mouse))}var i=e("./Util");c.prototype.on=function(e,t,n){var s,o,r,c,a,l;if(i.checkFunctionArg("Mouse.on",t))return this;for(e=i.normalizeInputArgs("Mouse.on",e,["left","middle","right","move"]),n=i.normalizeEventArgs("Mouse.on",n),a=0;a<e.length;a++)if(c=e[a],"move"===c)o=this.mouse,o.callbacks=o.callbacks||{},o.callbacks.move=o.callbacks.move||[],o.callbacks.move.push(t);else for(s=this.buttons[c]=this.buttons[c]||{},l=0;l<n.length;l++)r=n[l],s.callbacks=s.callbacks||{},s.callbacks[r]=s.callbacks[r]||[],s.callbacks[r].push(t);return this},c.prototype.off=function(e,t,n){var s,o,r,c,a,l;if(i.checkFunctionArg("Mouse.off",t))return this;for(e=i.normalizeInputArgs("Mouse.off",e,["left","middle","right","move"]),n=i.normalizeEventArgs("Mouse.off",n),a=0;a<e.length;a++)if(c=e[a],"move"===c)o=this.mouse,o.callbacks&&o.callbacks.move&&o.callbacks.move.splice(o.callbacks.move.indexOf(t));else for(s=this.buttons[c]=this.buttons[c]||{},l=0;l<n.length;l++)r=n[l],s.callbacks&&s.callbacks[r]&&s.callbacks[r].splice(s.callbacks[r].indexOf(t));return this},c.prototype.poll=function(e){var t,n,s,o={};if(e=i.normalizeInputArgs("Mouse.poll",e,["left","middle","right"]),1===e.length)return n=this.buttons[e[0]],n?n.state:"up";for(s=0;s<e.length;s++)t=e[s],n=this.buttons[t],o[t]=n?n.state:"up";return o},t.exports=c}()},{"./Util":10}],8:[function(e,t,n){!function(){"use strict";t.exports={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=","{":"[","}":"]","|":"\\",":":";",'"':"'","<":",",">":".","?":"/","`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+","[":"{","]":"}","\\":"|",";":":","":'"',",":"<",".":">","/":"?"}}()},{}],9:[function(e,t,n){!function(){"use strict";function n(e,t){return function(n){e.start=e[t]||{type:t,callbacks:[]},o.executeCallbacks(e.callbacks,t,n)}}function s(){this.touch={},document.addEventListener("touchstart",n(this.touch,"start"),!1),document.addEventListener("touchend",n(this.touch,"end"),!1),document.addEventListener("touchcancel",n(this.touch,"cancel"),!1),document.addEventListener("touchleave",n(this.touch,"leave"),!1),document.addEventListener("touchmove",n(this.touch,"move"),!1)}var o=e("./Util");s.prototype.on=function(e,t){var n,s,r;if(o.checkFunctionArg("Touch.on",t))return this;for(e=o.normalizeInputArgs("Touch.on",e,["start","end","cancel","leave","move"]),r=0;r<e.length;r++)s=e[r],n=this.touch,n[s]=n[s]||{type:s,callbacks:[]},n[s].callbacks.push(t);return this},s.prototype.off=function(e,t){var n,s,r,c;if(o.checkFunctionArg("Touch.off",t))return this;for(e=o.normalizeInputArgs("Touch.off",e,["start","end","cancel","leave","move"]),c=0;c<e.length;c++)r=e[c],n=this.touch,s=n[r].callbacks.indexOf(t),n[r]&&n[r].callbacks.splice(s,1);return this},t.exports=s}()},{"./Util":10}],10:[function(e,t,n){!function(){"use strict";t.exports={normalizeString:function(e){return e=e.toLowerCase(),e.replace(/[\s]/g," ")},checkFunctionArg:function(e,t){return"function"!=typeof t?(console.log("Argument 'callback' to '"+e+"' is not of type 'function', command ignored."),!0):!1},normalizeInputArgs:function(e,t,n){var s,o=[];for(t instanceof Array||(t=[t]),s=0;s<t.length;s++)"string"==typeof t[s]?n&&-1===n.indexOf(t[s])?console.log("Argument '"+t[s]+"' to '"+e+"' is not a recognized input type, argument removed."):o.push(this.normalizeString(t[s])):console.log("Argument '"+t[s]+"' to '"+e+"' is not of type 'string', argument removed.");return o},normalizeEventArgs:function(e,t){var n;for(t||(t=["press"]),t instanceof Array||(t=[t]),n=0;n<t.length;n++)"press"!==t[n]&&"release"!==t[n]?console.log("Argument '"+t[n]+"' to '"+e+"' is not a recognized event type, argument removed."):t[n]=this.normalizeString(t[n]);return t},executeCallbacks:function(e,t,n){var s;if(e&&e[t])for(e=e[t],s=0;s<e.length;s++)e[s](n)},mod:function(e,t){return(e%t+t)%t},isEmpty:function(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}}}()},{}]},{},[1])(1)});