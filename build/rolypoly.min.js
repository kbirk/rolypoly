!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.rolypoly=e()}}(function(){return function e(t,n,s){function o(i,c){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!c&&l)return l(i,!0);if(r)return r(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){var n=t[i][1][e];return o(n?n:e)},u,u.exports,e,t,n,s)}return n[i].exports}for(var r="function"==typeof require&&require,i=0;i<s.length;i++)o(s[i]);return o}({1:[function(e,t,n){!function(){"use strict";t.exports={Keyboard:e("./Keyboard"),Mouse:e("./Mouse")}}()},{"./Keyboard":5,"./Mouse":7}],2:[function(e,t,n){!function(){"use strict";function n(e){e=e||256,this.buffer=new Array(e),this.length=e,this.index=0}var s=e("./Util");n.prototype.push=function(e){this.buffer[this.index]=e,this.index=(this.index+1)%this.length},n.prototype.back=function(e){return e=e?e:0,this.buffer[s.mod(this.index-1-e,this.length)]},t.exports=n}()},{"./Util":9}],3:[function(e,t,n){!function(){"use strict";t.exports={BACKSPACE:"backspace",TAB:"tab",ENTER:"enter",SHIFT:"shift",CTRL:"ctrl",ALT:"alt",PAUSE_BREAK:"pausebreak",CAPS_LOCK:"capslock",ESC:"esc",PAGE_UP:"pageup",PAGE_DOWN:"pagedown",END:"end",HOME:"home",LEFT_ARROW:"left",UP_ARROW:"up",RIGHT_ARROW:"right",DOWN_ARROW:"down",PRINT_SCREEN:"printscreen",INSERT:"insert",DELETE:"delete",WINDOWS:"windows",SELECT:"select",SPACE_BAR:"space",NUM_LOCK:"numlock",SCROLL_LOCK:"scrolllock"}}()},{}],4:[function(e,t,n){!function(){"use strict";var n=e("./KeyEnums");t.exports={8:n.BACKSPACE,9:n.TAB,13:n.ENTER,16:n.SHIFT,17:n.CTRL,18:n.ALT,19:n.PAUSE_BREAK,20:n.CAPS_LOCK,27:n.ESC,32:n.SPACE_BAR,33:n.PAGE_UP,34:n.PAGE_DOWN,35:n.END,36:n.HOME,37:n.LEFT_ARROW,38:n.UP_ARROW,39:n.RIGHT_ARROW,40:n.DOWN_ARROW,44:n.PRINT_SCREEN,45:n.INSERT,46:n.DELETE,48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:n.WINDOWS,92:n.WINDOWS,93:n.SELECT,96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:n.NUM_LOCK,145:n.SCROLL_LOCK,186:":",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}}()},{"./KeyEnums":3}],5:[function(e,t,n){!function(){"use strict";function n(e,t){var n;for(n=0;n<t.length;n++)if(!C[t[n]])return console.log("Argument '"+t[n]+"' to '"+e+"' is not a recognized event type, command ignored."),!0;return!1}function s(e){return e.split(" ").length>1}function o(e){return e.split(" ")}function r(e){return e.length>1?e.split("+").length>1:!1}function i(e){var t,n=e.split(/\+\+\+|\+\+/),s=[];if(n.length>1)for(t=0;t<n.length;t++)0===n[t].length?0===t&&s.push("+"):(s=s.concat(n[t].split("+")),t!==n.length-1&&s.push("+"));else s=e.split("+");return s}function c(e,t,s,r){var i,c,l,a,u=o(t),f=e.keys,p=e.sequences;if(!n("Keyboard.on",u))for(p[t]=p[t]||{keys:u,lastKey:u[u.length-1],callbacks:{}},i=p[t],a=0;a<s.length;a++)for(c=s[a],i.callbacks[c]=i.callbacks[c]||[],i.callbacks[c].push(r),a=0;a<u.length;a++)l=u[a],f[l]=f[l]||{},f[l].sequences=f[l].sequences||{},f[l].sequences[c]=f[l].sequences[c]||[],-1===f[l].sequences[c].indexOf(t)&&f[l].sequences[c].push(t)}function l(e,t,s,r){var i,c,l,a,u=o(t),f=e.keys,p=e.sequences,h=p[t];if(!n("Keyboard.off",u)&&h){for(a=0;a<s.length;a++)c=s[a],i=h.callbacks,i&&i[c]&&(i[c].splice(i[c].indexOf(r),1),0===i[c].length&&delete i[c]);if(x.isEmpty(h.callbacks))for(delete p[t],a=0;a<s.length;a++)for(c=s[a],a=0;a<u.length;a++)l=u[a],p=f[l].sequences[c],p.splice(p.indexOf(t),1)}}function a(e,t,s,o){var r,c,l,a,u=i(t),f=e.keys,p=e.combos;if(!n("Keyboard.on",u))for(p[t]=p[t]||{keys:u,callbacks:{}},r=p[t],a=0;a<s.length;a++)for(c=s[a],r.callbacks[c]=r.callbacks[c]||[],r.callbacks[c].push(o),a=0;a<u.length;a++)l=u[a],f[l]=f[l]||{},f[l].combos=f[l].combos||{},f[l].combos[c]=f[l].combos[c]||[],-1===f[l].combos[c].indexOf(t)&&f[l].combos[c].push(t)}function u(e,t,s,o){var r,c,l,a,u=i(t),f=e.keys,p=e.combos,h=p[t];if(!n("Keyboard.off",u)&&h){for(a=0;a<s.length;a++)c=s[a],r=h.callbacks,r&&r[c]&&(r[c].splice(r[c].indexOf(o),1),0===r[c].length&&delete r[c]);if(x.isEmpty(h.callbacks))for(delete p[t],a=0;a<s.length;a++)for(c=s[a],a=0;a<u.length;a++)l=u[a],p=f[l].combos[c],p.splice(p.indexOf(t),1)}}function f(e,t,s,o){var r,i,c=e.keys,l=c[t]=c[t]||{};if(!n("Keyboard.on",[t]))for(i=0;i<s.length;i++)r=s[i],l.callbacks=l.callbacks||{},l.callbacks[r]=l.callbacks[r]||[],l.callbacks[r].push(o)}function p(e,t,s,o){var r,i,c,l=e.keys,a=l[t];if(!n("Keyboard.off",[t])&&a)for(c=0;c<s.length;c++)i=s[c],r=a.callbacks,r&&r[i]&&(r[i].splice(r[i].indexOf(o),1),0===r[i].length&&delete r[i])}function h(e,t,n){var s,o,r=e.keys,i=t.keys;for(o=0;o<i.length;o++){if(s=r[i[o]],!s)return!1;if("release"===n&&(!t.pressed||"up"!==s.state))return!1;if("press"===n&&"down"!==s.state)return!1}return"press"===n?t.pressed=!0:"release"===n&&delete t.pressed,!0}function b(e,t,n,s){var o,r,i=e.combos;if(t.combos)if("press"===n){if(t.combos.press)for(r=0;r<t.combos.press.length;r++)o=i[t.combos.press[r]],h(e,o,"press")&&x.executeCallbacks(o.callbacks,"press",s);if(t.combos.release)for(r=0;r<t.combos.release.length;r++)o=i[t.combos.release[r]],h(e,o,"press")}else if(t.combos.release)for(r=0;r<t.combos.release.length;r++)o=i[t.combos.release[r]],h(e,o,"release")&&x.executeCallbacks(o.callbacks,"release",s)}function d(e,t){var n;return e?(n=e-t,_>n):!0}function m(e,t){var n,s,o,r,i;for(r=0,i=0;r<t.length;r++,i++){for(s=t[t.length-1-r],o=e.back(i);"shift"!==s&&o&&"shift"===o.keyId;)i++,o=e.back(i);if(!o||o.keyId!==s||!d(n,o.timestamp))return!1;n=o.timestamp}return!0}function g(e,t,n,s,o){var r,i,c,l=e.sequences;if(t.sequences&&t.sequences[s])for(i="press"===s?e.pressHistory:e.releaseHistory,c=0;c<t.sequences[s].length;c++)r=l[t.sequences[s][c]],r.lastKey===n&&m(i,r.keys)&&x.executeCallbacks(r.callbacks,s,o)}function y(e){var t=e.charCode||e.keyCode;return K[t]||t}function k(e,t){var n=e[O.SHIFT];return n&&"down"===n.state?R[t]||t:t}function v(e){return function(t){var n,s=y(t),o=e.keys;s=k(o,s),n=o[s]=o[s]||{},n.state="down",e.pressHistory.push({keyId:s,timestamp:Date.now()}),x.executeCallbacks(n.callbacks,"press",t),b(e,n,"press",t),g(e,n,s,"press",t)}}function E(e){return function(t){var n,s=y(t),o=e.keys;s=k(o,s),n=o[s],n&&"down"===n.state&&(n.state="up",e.releaseHistory.push({keyId:s,timestamp:Date.now()}),x.executeCallbacks(n.callbacks,"release",t),b(e,n,"release",t),g(e,n,s,"release",t))}}function A(){this.keys={},this.combos={},this.sequences={},this.pressHistory=new S(w),this.releaseHistory=new S(w),document.addEventListener("keydown",v(this)),document.addEventListener("keyup",E(this))}var x=e("./Util"),C=e("./Keys"),O=e("./KeyEnums"),K=e("./KeyMap"),R=e("./ShiftMap"),S=e("./CircularArray"),_=800,w=64;A.prototype.on=function(e,t,n){var o,i;if(x.checkFunctionArg("Keyboard.on",t))return this;for(e=x.normalizeInputArgs("Keyboard.on",e),n=x.normalizeEventArgs("Keyboard.on",n),i=0;i<e.length;i++)o=e[i],s(o)?c(this,o,n,t):r(o)?a(this,o,n,t):f(this,o,n,t);return this},A.prototype.off=function(e,t,n){var o,i;if(x.checkFunctionArg("Keyboard.off",t))return this;for(e=x.normalizeInputArgs("Keyboard.off",e),n=x.normalizeEventArgs("Keyboard.off",n),i=0;i<e.length;i++)o=e[i],s(o)?l(this,o,n,t):r(o)?u(this,o,n,t):p(this,o,n,t);return this},A.prototype.poll=function(e){var t,n,s,o={};if(e=x.normalizeInputArgs("Keyboard.poll",e),1===e.length)return n=this.keys[e[0]],n?n.state:"up";for(s=0;s<e.length;s++)t=e[s],n=this.keys[t],o[t]=n?n.state:"up";return o},t.exports=A}()},{"./CircularArray":2,"./KeyEnums":3,"./KeyMap":4,"./Keys":6,"./ShiftMap":8,"./Util":9}],6:[function(e,t,n){!function(){"use strict";var n,s=e("./KeyMap"),o=e("./ShiftMap"),r={};for(n in s)r[s[n]]=!0;for(n in o)r[o[n]]=!0;t.exports=r}()},{"./KeyMap":4,"./ShiftMap":8}],7:[function(e,t,n){!function(){"use strict";function n(e){switch(e.button){case 0:return"left";case 1:return"middle";case 2:return"right"}}function s(e){return function(t){var s,o=n(t);s=e[o]=e[o]||{state:null},s.state="down",c.executeCallbacks(s.callbacks,"press",t)}}function o(e){return function(t){var s=n(t),o=e[s];o&&"down"===o.state&&(c.executeCallbacks(o.callbacks,"release",t),o.state="up")}}function r(e){var t=null;return function(n){t&&n.clientX===t.x&&n.clientY===t.y||(t&&(n.previousClientX=t.x,n.previousClientY=t.y),c.executeCallbacks(e.callbacks,"move",n),t={x:n.clientX,y:n.clientY})}}function i(){this.buttons={},this.mouse={},document.addEventListener("mousedown",s(this.buttons)),document.addEventListener("mouseup",o(this.buttons)),document.addEventListener("mousemove",r(this.mouse))}var c=e("./Util");i.prototype.on=function(e,t,n){var s,o,r,i,l,a;if(c.checkFunctionArg("Mouse.on",t))return this;for(e=c.normalizeInputArgs("Mouse.on",e,["left","middle","right","move"]),n=c.normalizeEventArgs("Mouse.on",n),l=0;l<e.length;l++)if(i=e[l],"move"===i)o=this.mouse,o.callbacks=o.callbacks||{},o.callbacks.move=o.callbacks.move||[],o.callbacks.move.push(t);else for(s=this.buttons[i]=this.buttons[i]||{},a=0;a<n.length;a++)r=n[a],s.callbacks=s.callbacks||{},s.callbacks[r]=s.callbacks[r]||[],s.callbacks[r].push(t);return this},i.prototype.off=function(e,t,n){var s,o,r,i,l,a;if(c.checkFunctionArg("Mouse.off",t))return this;for(e=c.normalizeInputArgs("Mouse.off",e,["left","middle","right","move"]),n=c.normalizeEventArgs("Mouse.off",n),l=0;l<e.length;l++)if(i=e[l],"move"===i)o=this.mouse,o.callbacks&&o.callbacks.move&&o.callbacks.move.splice(o.callbacks.move.indexOf(t));else for(s=this.buttons[i]=this.buttons[i]||{},a=0;a<n.length;a++)r=n[a],s.callbacks&&s.callbacks[r]&&s.callbacks[r].splice(s.callbacks[r].indexOf(t));return this},i.prototype.poll=function(e){var t,n,s,o={};if(e=c.normalizeInputArgs("Mouse.poll",e,["left","middle","right"]),1===e.length)return n=this.buttons[e[0]],n?n.state:"up";for(s=0;s<e.length;s++)t=e[s],n=this.buttons[t],o[t]=n?n.state:"up";return o},t.exports=i}()},{"./Util":9}],8:[function(e,t,n){!function(){"use strict";t.exports={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=","{":"[","}":"]","|":"\\",":":";",'"':"'","<":",",">":".","?":"/","`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+","[":"{","]":"}","\\":"|",";":":","":'"',",":"<",".":">","/":"?"}}()},{}],9:[function(e,t,n){!function(){"use strict";t.exports={normalizeString:function(e){return e=e.toLowerCase(),e.replace(/[\s]/g," ")},checkFunctionArg:function(e,t){return"function"!=typeof t?(console.log("Argument 'callback' to '"+e+"' is not of type 'function', command ignored."),!0):!1},normalizeInputArgs:function(e,t,n){var s,o=[];for(t instanceof Array||(t=[t]),s=0;s<t.length;s++)"string"==typeof t[s]?n&&-1===n.indexOf(t[s])?console.log("Argument '"+t[s]+"' to '"+e+"' is not a recognized input type, argument removed."):o.push(this.normalizeString(t[s])):console.log("Argument '"+t[s]+"' to '"+e+"' is not of type 'string', argument removed.");return o},normalizeEventArgs:function(e,t){var n;for(t||(t=["press"]),t instanceof Array||(t=[t]),n=0;n<t.length;n++)"press"!==t[n]&&"release"!==t[n]?console.log("Argument '"+t[n]+"' to '"+e+"' is not a recognized event type, argument removed."):t[n]=this.normalizeString(t[n]);return t},executeCallbacks:function(e,t,n){var s;if(e&&e[t])for(e=e[t],s=0;s<e.length;s++)e[s](n)},mod:function(e,t){return(e%t+t)%t},isEmpty:function(e){var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}}}()},{}]},{},[1])(1)});